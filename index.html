<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Alarm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .alarm-container {
            max-width: 500px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .alarm-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .alarm-item {
            transition: background-color 0.3s;
        }
        .alarm-item:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body>
    <div class="alarm-container">
        <h3 class="text-center mb-4">Custom Alarm</h3>
        <form id="alarmForm" class="mb-4">
            <div class="mb-3">
                <label for="alarmTime" class="form-label">Set Alarm Time</label>
                <input type="time" class="form-control" id="alarmTime" required>
            </div>
            <div class="mb-3">
                <label for="alarmNote" class="form-label">Note (optional)</label>
                <input type="text" class="form-control" id="alarmNote" placeholder="Enter note for this alarm">
            </div>
            <div class="mb-3">
                <label for="alarmSoundSelect" class="form-label">Select Sound</label>
                <select class="form-select" id="alarmSoundSelect" required>
                    <option value="alarm.mp3">Alarm</option>
                    <option value="adzan.mp3">Adzan</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Add Alarm</button>
        </form>
        <div class="alarm-list">
            <h5>Scheduled Alarms</h5>
            <ul id="alarmList" class="list-group">
                <!-- Alarms will be added here dynamically -->
            </ul>
        </div>
    </div>

    <audio id="alarmSound" src="alarm.mp3"></audio>

    <script>
        const alarmForm = document.getElementById('alarmForm');
        const alarmTimeInput = document.getElementById('alarmTime');
        const alarmNoteInput = document.getElementById('alarmNote');
        const alarmSoundSelect = document.getElementById('alarmSoundSelect');
        const alarmList = document.getElementById('alarmList');
        const alarmSound = document.getElementById('alarmSound');
        let alarms = [];

        // Load alarms from localStorage if available
        if (localStorage.getItem('alarms')) {
            alarms = JSON.parse(localStorage.getItem('alarms'));
            renderAlarms();
        }

        alarmForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const time = alarmTimeInput.value;
            const note = alarmNoteInput.value || 'No note';
            const sound = alarmSoundSelect.value;
            if (time && sound) {
                alarms.push({ time, note, sound });
                alarms.sort((a, b) => a.time.localeCompare(b.time)); // Sort alarms by time
                localStorage.setItem('alarms', JSON.stringify(alarms));
                renderAlarms();
                alarmTimeInput.value = '';
                alarmNoteInput.value = '';
                alarmSoundSelect.value = 'alarm.mp3';
            }
        });

        function renderAlarms() {
            alarmList.innerHTML = '';
            alarms.forEach((alarm, index) => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center alarm-item';
                li.innerHTML = `
                    <div>
                        <strong>${alarm.time}</strong>
                        <small class="text-muted d-block">${alarm.note}</small>
                        <small class="text-muted d-block">Sound: ${alarm.sound === 'alarm.mp3' ? 'Alarm' : 'Adzan'}</small>
                    </div>
                    <div>
                        <button class="btn btn-primary btn-sm me-2" onclick="toggleSound(${index})">
                            ${alarm.sound === 'alarm.mp3' ? 'Use Adzan' : 'Use Alarm'}
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteAlarm(${index})">Delete</button>
                    </div>
                `;
                alarmList.appendChild(li);
            });
        }

        function toggleSound(index) {
            alarms[index].sound = alarms[index].sound === 'alarm.mp3' ? 'adzan.mp3' : 'alarm.mp3';
            localStorage.setItem('alarms', JSON.stringify(alarms));
            renderAlarms();
        }

        function deleteAlarm(index) {
            alarms.splice(index, 1);
            localStorage.setItem('alarms', JSON.stringify(alarms));
            renderAlarms();
        }

        // Check alarms every second
        setInterval(() => {
            const now = new Date();
            const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            alarms.forEach((alarm) => {
                if (alarm.time === currentTime) {
                    alarmSound.src = alarm.sound;
                    alarmSound.play().catch(error => {
                        console.error('Error playing alarm:', error);
                    });
                }
            });
        }, 1000);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
